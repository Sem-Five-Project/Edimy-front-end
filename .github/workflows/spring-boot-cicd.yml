# name: CI/CD Pipeline for Spring Boot

# on:
#   pull_request:
#     branches:
#       - host_dev

# jobs:
#   test:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4

#       - name: Set up JDK 17
#         uses: actions/setup-java@v4
#         with:
#           java-version: '17'
#           distribution: 'temurin'
#           cache: maven

#       - name: Run Unit and Integration Tests
#         run: mvn clean verify

#       - name: Upload test results
#         if: always()
#         uses: actions/upload-artifact@v4
#         with:
#           name: test-results
#           path: target/surefire-reports/

#   deploy:
#     needs: test
#     runs-on: ubuntu-latest
#     if: github.event.pull_request.merged == true
#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4

#       - name: Set up JDK 17
#         uses: actions/setup-java@v4
#         with:
#           java-version: '17'
#           distribution: 'temurin'
#           cache: maven

#       - name: Build with Maven
#         run: mvn clean package -DskipTests

#       - name: Deploy to Railway
#         env:
#           RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
#         run: |
#           curl -X POST \
#             -H "Authorization: Bearer $RAILWAY_TOKEN" \
#             -H "Content-Type: application/json" \
#             -d '{"serviceId": "${{ secrets.RAILWAY_SERVICE_ID }}", "repo": "${{ github.repository }}", "branch": "host_dev"}' \
#             https://backboard.railway.app/api/v2/services/deploy